/*!
 * @author Jan Nejedly support@3b-fly.eu
 * @copyright Jan Nejedly
 * @version 2.0.0
 * @license see license in 'LICENSE' file
*/

var bbbfly=bbbfly||{};bbbfly.menu={};bbbfly.menubar={};bbbfly.menu._normalizeItems=function(a){a.Data.Items=bbbfly.menu._itemsToArray(a.Data.Items)};bbbfly.menu._itemsToArray=function(a){if(Array.isArray(a))return a;if(!Object.isObject(a))return[];var b=[],c;for(c in a){var e=a[c];0<b.length&&b.push({Text:"-"});for(var d in e){var f=e[d];f.SubMenu&&(f.SubMenu=bbbfly.menu._itemsToArray(f.SubMenu));b.push(f)}}return b};
bbbfly.menu._add=function(a,b){"undefined"===typeof a.CloseOnClick&&(a.CloseOnClick=!a.SubMenu);a.Owner=this;this.Add.callParent(a,b)};bbbfly.menu._onMenuClick=function(a,b,c){"undefined"===typeof c.Checked&&"undefined"===typeof c.RadioGroup||b.CheckItem(c,!c.Checked);return!!c.CloseOnClick};bbbfly.menubar._doCreate=function(a,b,c){this.DoCreate.callParent(a,b,c);this.FillItems()};bbbfly.menubar._setItems=function(a){if(!Object.isObject(a))return!1;this.Items=a;this.FillItems();this.Update();return!0};
bbbfly.menubar._fillItems=function(){var a;for(a in this._Buttons){var b=this._Buttons[a];Function.isFunction(b.Dispose)&&(delete this._Buttons[a],b.Dispose())}var c=this.Items;if(Object.isObject(c)){var e=bbbfly.PanelGroup.NewGroupId();for(a in c)if(c.hasOwnProperty(a)&&(b=c[a],Object.isObject(b))){var d={ID:String.isString(b.ID)?b.ID:a,Group:{Selected:e}};String.isString(b.Alt)&&(d.Alt=b.Alt);String.isString(b.AltRes)&&(d.AltRes=b.AltRes);String.isString(b.Text)&&(d.Text=b.Text);String.isString(b.TextRes)&&
(d.TextRes=b.TextRes);Boolean.isBoolean(b.Visible)&&(d.Visible=b.Visible);Boolean.isBoolean(b.Enabled)&&(d.Enabled=b.Enabled);Object.isObject(b.Icon)&&(d.Icon=b.Icon);d={Data:d};b=this.CreateItemButton(b,d);this._Buttons[b.ID]=b}}};bbbfly.menubar._createItemButton=function(a,b){if(!Object.isObject(a))return null;Object.isObject(b)||(b={});var c=this.ButtonDef;Object.isObject(c)&&ng_MergeDef(b,c);b=this.CreateControl(b);if(!b)return null;b._Bar=this;b._Item=a;return b};
bbbfly.menubar._onButtonClick=function(){var a=this._Bar;Object.isObject(a)&&Function.isFunction(a.OnItemClick)&&a.OnItemClick(this._Item,this.Selected)};bbbfly.menubar._onButtonSelectedChanged=function(){var a=this._Bar;Object.isObject(a)&&Function.isFunction(a.OnItemSelectedChanged)&&a.OnItemSelectedChanged(this._Item,this.Selected)};
bbbfly.Menu=function(a,b,c){a=a||{};ng_MergeDef(a,{Data:{Items:null},Events:{OnMenuClick:bbbfly.menu._onMenuClick},Methods:{Add:bbbfly.menu._add}});bbbfly.menu._normalizeItems(a);return ngCreateControlAsType(a,"ngMenu",b,c)};
bbbfly.MenuBar=function(a,b,c){a=a||{};ng_MergeDef(a,{Data:{WrapperOptions:{TrackChanges:!0},ButtonDef:{Type:"bbbfly.Button",Data:{SelectType:bbbfly.Button.selecttype.click},Events:{OnSelectedChanged:bbbfly.menubar._onButtonSelectedChanged,OnClick:bbbfly.menubar._onButtonClick}},Items:null,_Buttons:{}},Events:{OnItemClick:null,OnItemSelectedChanged:null},Methods:{DoCreate:bbbfly.menubar._doCreate,SetItems:bbbfly.menubar._setItems,FillItems:bbbfly.menubar._fillItems,CreateItemButton:bbbfly.menubar._createItemButton}});
return ngCreateControlAsType(a,"bbbfly.Wrapper",b,c)};ngUserControls=ngUserControls||[];ngUserControls.bbbfly_menu={OnInit:function(){ngRegisterControlType("bbbfly.Menu",bbbfly.Menu);ngRegisterControlType("bbbfly.MenuBar",bbbfly.MenuBar)}};
