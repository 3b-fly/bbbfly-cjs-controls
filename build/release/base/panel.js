/*!
 * @author Jan Nejedly support@3b-fly.eu
 * @copyright Jan Nejedly
 * @version 2.0.0
 * @license see license in 'LICENSE' file
*/

var bbbfly=bbbfly||{};bbbfly.panel={};bbbfly.frame={};bbbfly.panel._doUpdate=function(a){this.DoUpdateHtml(a);return!0};bbbfly.panel._doMouseEnter=function(){this.DoUpdateHtml()};bbbfly.panel._doMouseLeave=function(){this.DoUpdateHtml()};
bbbfly.panel._doUpdateHtml=function(a){"undefined"===typeof a&&(a=this.Elm());if(a){a.className=this.GetClassName();var b=this.GetState();Object.isObject(b)||(b={});var c={disabled:"D",invalid:"I",selected:"S",grayed:"G",highlight:"h",mouseOver:"o"},d;for(d in c)b[d]?a.setAttribute(c[d],"1"):a.removeAttribute(c[d])}};bbbfly.panel._getState=function(){return{disabled:!this.Enabled,invalid:!!this.Invalid,mouseOver:!(this.ReadOnly||!ngMouseInControls[this.ID])}};
bbbfly.panel._getClassName=function(a){return String.isString(a)?this.BaseClassName+a:this.BaseClassName};bbbfly.panel._getControlsHolder=function(){return this};bbbfly.panel._doChangeState=function(a){a?this.Update():this.DoUpdateHtml()};
bbbfly.panel._setEnabled=function(a,b){Boolean.isBoolean(a)||(a=!0);if(this.Enabled===a)return!0;if(Function.isFunction(this.OnSetEnabled)&&!this.OnSetEnabled(a))return!1;Boolean.isBoolean(b)||(b=!0);this.SetChildControlsEnabled(a,this);this.Enabled=a;this.DoChangeState(b);Function.isFunction(this.OnEnabledChanged)&&this.OnEnabledChanged();return!0};
bbbfly.panel._setInvalid=function(a,b){Boolean.isBoolean(a)||(a=!0);if(this.Invalid===a)return!0;if(Function.isFunction(this.OnSetInvalid)&&!this.OnSetInvalid(a))return!1;Boolean.isBoolean(b)||(b=!0);this.Invalid=a;this.DoChangeState(b);Function.isFunction(this.OnInvalidChanged)&&this.OnInvalidChanged();return!0};
bbbfly.panel._setReadOnly=function(a,b){Boolean.isBoolean(a)||(a=!0);if(a===this.ReadOnly)return!0;if(Function.isFunction(this.OnSetReadOnly)&&!this.OnSetReadOnly(a))return!1;Boolean.isBoolean(b)||(b=!0);this.ReadOnly=a;this.DoChangeState(b);Function.isFunction(this.OnReadOnlyChanged)&&this.OnReadOnlyChanged();return!0};
bbbfly.frame._doCreate=function(a,b,c){if(this.Frame){var d={FramePanel:{},ControlsPanel:{}};Object.isObject(a.FramePanel)&&(d.FramePanel=a.FramePanel);Object.isObject(a.ControlsPanel)&&(d.ControlsPanel=a.ControlsPanel);ng_MergeDef(d,{FramePanel:{L:0,T:0,R:0,B:0,Type:"bbbfly.Panel",id:this.ID+"_F",ScrollBars:ssNone,style:{zIndex:1},className:this.BaseClassName+"FramePanel",Data:{_FrameProxy:null,_FrameHtml:""}},ControlsPanel:{L:0,T:0,R:0,B:0,Type:"bbbfly.Panel",id:this.ID+"_P",ScrollBars:ssAuto,style:{zIndex:2},
Controls:a.Controls,ModifyControls:a.ModifyControls,className:this.BaseClassName+"ControlsPanel"}});a.ParentReferences||(this.Controls={},this.Controls.Owner=this,b=this.Controls);c=ngCreateControls(d,void 0,c);this.ControlsPanel=c.ControlsPanel;this.ControlsPanel.Owner=this;this.FramePanel=c.FramePanel;this.FramePanel.Owner=this;delete a.Controls;delete a.ModifyControls;delete c.ControlsPanel;delete c.FramePanel;ngCloneRefs(b,c)}};
bbbfly.frame._doUpdate=function(a){this.DoUpdateFrame(a);this.DoUpdateControlsPanel(a);return this.DoUpdate.callParent(a)};bbbfly.frame._doMouseEnter=function(){this.DoMouseEnter.callParent();var a=this.GetFramePanel();if(a&&(a=a._FrameProxy,Object.isObject(a))){var b=this.GetState();bbbfly.Renderer.UpdateFrameHTML(a,b)}};
bbbfly.frame._doMouseLeave=function(){this.DoMouseLeave.callParent();var a=this.GetFramePanel();if(a&&(a=a._FrameProxy,Object.isObject(a))){var b=this.GetState();bbbfly.Renderer.UpdateFrameHTML(a,b)}};bbbfly.frame._doChangeState=function(a){this.DoChangeState.callParent(a);a||this.DoUpdateImages()};
bbbfly.frame._doUpdateFrame=function(a){"undefined"===typeof a&&(a=this.Elm());var b=this.GetFramePanel();if(a&&b){ng_BeginMeasureElement(a);var c=ng_ClientWidth(a),d=ng_ClientHeight(a);ng_EndMeasureElement(a);b.SetBounds({T:0,L:0,W:c,H:d});if(a=b.Elm()){var e=this.GetFrame();c=this.GetState();d=c.mouseOver;c.mouseOver=!1;e=bbbfly.Renderer.FrameProxy(e,c,this.ID);var f=bbbfly.Renderer.FrameHTML(e,c);c.mouseOver=d;b._FrameProxy=e;f!==b._FrameHtml&&(b._FrameHtml=f,a.innerHTML=f,d&&bbbfly.Renderer.UpdateFrameHTML(e,
c))}}};bbbfly.frame._doUpdateImages=function(){var a=this.GetFramePanel();if(a&&(a=a._FrameProxy,Object.isObject(a))){var b=this.GetState();bbbfly.Renderer.UpdateFrameProxy(a,b);bbbfly.Renderer.UpdateFrameHTML(a,b)}};
bbbfly.frame._doUpdateControlsPanel=function(a){"undefined"===typeof a&&(a=this.Elm());var b=this.GetControlsPanel();if(a&&b){ng_BeginMeasureElement(a);var c=ng_ClientWidth(a),d=ng_ClientHeight(a);ng_EndMeasureElement(a);a=this.GetFrameDims();b.SetBounds({W:c-a.L-a.R,H:d-a.T-a.B,T:a.T,L:a.L,R:null,B:null})}};bbbfly.frame._getFrame=function(){return Object.isObject(this.Frame)?this.Frame:{}};
bbbfly.frame._getFrameDims=function(){var a={L:0,T:0,R:0,B:0},b=this.GetFramePanel();b&&Object.isObject(b._FrameProxy)&&(a.L=b._FrameProxy.L.W,a.T=b._FrameProxy.T.H,a.R=b._FrameProxy.R.W,a.B=b._FrameProxy.B.H);return a};bbbfly.frame._getFramePanel=function(){return this.FramePanel?this.FramePanel:null};bbbfly.frame._getControlsPanel=function(){return this.ControlsPanel?this.ControlsPanel:null};bbbfly.frame._getControlsHolder=function(){var a=this.GetControlsPanel();return a?a:this.GetControlsHolder.callParent()};
bbbfly.Panel=function(a,b,c){a=a||{};ng_MergeDef(a,{Data:{Enabled:!0,Invalid:!1,ReadOnly:!1},ParentReferences:!0,Events:{OnSetEnabled:null,OnEnabledChanged:null,OnSetInvalid:null,OnInvalidChanged:null,OnSetReadOnly:null,OnReadOnlyChanged:null},Methods:{DoUpdate:bbbfly.panel._doUpdate,DoMouseEnter:bbbfly.panel._doMouseEnter,DoMouseLeave:bbbfly.panel._doMouseLeave,DoChangeState:bbbfly.panel._doChangeState,DoUpdateHtml:bbbfly.panel._doUpdateHtml,GetState:bbbfly.panel._getState,GetClassName:bbbfly.panel._getClassName,
GetControlsHolder:bbbfly.panel._getControlsHolder,SetEnabled:bbbfly.panel._setEnabled,SetInvalid:bbbfly.panel._setInvalid,SetReadOnly:bbbfly.panel._setReadOnly}});return ngCreateControlAsType(a,"ngPanel",b,c)};
bbbfly.Frame=function(a,b,c){a=a||{};ng_MergeDef(a,{Data:{Frame:!1},FramePanel:void 0,ControlsPanel:void 0,Methods:{DoCreate:bbbfly.frame._doCreate,DoUpdate:bbbfly.frame._doUpdate,DoMouseEnter:bbbfly.frame._doMouseEnter,DoMouseLeave:bbbfly.frame._doMouseLeave,DoChangeState:bbbfly.frame._doChangeState,DoUpdateFrame:bbbfly.frame._doUpdateFrame,DoUpdateImages:bbbfly.frame._doUpdateImages,DoUpdateControlsPanel:bbbfly.frame._doUpdateControlsPanel,GetFrame:bbbfly.frame._getFrame,GetFrameDims:bbbfly.frame._getFrameDims,
GetFramePanel:bbbfly.frame._getFramePanel,GetControlsPanel:bbbfly.frame._getControlsPanel,GetControlsHolder:bbbfly.frame._getControlsHolder}});return ngCreateControlAsType(a,"bbbfly.Panel",b,c)};ngUserControls=ngUserControls||[];ngUserControls.bbbfly_panel={OnInit:function(){ngRegisterControlType("bbbfly.Panel",bbbfly.Panel);ngRegisterControlType("bbbfly.Frame",bbbfly.Frame)}};
